<div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
    <div id="kt_app_toolbar_container" class="app-container container-fluid d-flex flex-stack">
        <div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
        <h1 class="page-heading d-flex text-gray-900 fw-bold fs-3 flex-column justify-content-center my-0">Menú Principal</h1>
        <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
            <li class="breadcrumb-item text-muted">
                <font class="text-muted">Operaciones</font>
            </li>
            <li class="breadcrumb-item">
                <span class="bullet bg-gray-500 w-5px h-2px"></span>
            </li>
            <li class="breadcrumb-item text-muted">Venta y Reserva de pasajes</li>
        </ul>
        </div>
        
        <!--<div class="d-flex align-items-center gap-2 gap-lg-3">
            <div class="m-0">
                <button class="btn btn-sm btn-flex btn-secondary fw-bold" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                    <i class="ki-outline ki-magnifier fs-6 text-muted me-1"></i> Buscar
                </button>
            </div>
            <button class="btn btn-sm fw-bold btn-primary" data-bs-toggle="modal" data-bs-target="#kt_modal_create_app">Botón</button>
        </div>-->
        
    </div>
</div>

<div id="kt_app_content" class="app-content flex-column-fluid">
    <div id="kt_app_content_container" class="app-container container-fluid">
        <div id="div_confirmar_pasaje" class="row g-5 gx-xl-10 mb-5">
            <div class="col-md-7" style="display: inline-block; font-size: 26px; font-weight: bold; color: #ff6719; text-decoration: underline;">
                {{titulo_confirmar_pasaje}}
            </div>
            <br>
            <div class="col-xxl-8 col-9" style="display: inline-block;">
                <div class="card card-itinerario">
                    <div class="row g-0" style="display: flex; justify-content: center; border: 1px solid #cdcdcd;">
                        <div class="col-10 div_servicio_cpas">
                            <div style="margin-top: 2%; text-align: left;">
                                <div class="servicio_cpas">Servicio 
                                    <font class="servicio_detall_cpas">{{servicioIda}}</font> 
                                    <div class="icon_detalle_cpas"><font style="font-weight: bold;">Ida</font>&nbsp;<i class="fal fa-calendar-check"></i>&nbsp;{{this.funcionesService.convert_format_fecha_barra(fechaEmbarqueIda)}}</div>
                                </div>
                            </div>
                            <div class="col-12 col-lg-12">
                                <div class="row" style="margin-top: 10px;">
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="font_ruta_cpas">{{nombre_ciudad_origen}}</span>
                                    </div>
                                    <div class="col-2" style="text-align: center;">
                                        <i class="fal fa-long-arrow-right icon_flecha_cpas"></i>
                                    </div>
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="font_ruta2_cpas">{{nombre_ciudad_destino}}</span>
                                    </div>
                                </div>
                                <div class="row" style="margin-top: -12px;">
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="dat_salida_embar_cpas">Embarque</span>
                                        <span class="dat_hora_embar_cpas">{{horaEmbarqueIda}} h</span>
                                    </div>
                                    <div class="col-2" style="text-align: center;">&nbsp;</div>
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="dat_llegada_desem_cpas">Desembarque</span>
                                        <span class="dat_hora_desem_cpas">{{horaDesembarqueIda}} h</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-10 margin_embarque_desembarque_cpas">
                            <div class="row">
                                <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                    <span class="dat_salida_embar_detall_cpas">{{agenciaEmbarqueIda}}</span>
                                </div>
                                <div class="col-2" style="text-align: center;">&nbsp;</div>
                                <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                    <span class="dat_llegada_desem_detall_cpas">{{agenciaDesembarqueIda}}</span>
                                </div>
                            </div>
                        </div>

                        <table style="margin-top: 8px;">
                            <thead class="border_table_head_cpas">
                                <th class="text-center border_table_head_cpas">#</th>
                                <th class="text-center border_table_head_cpas">Nombre del Pasajero</th>
                                <th class="text-center border_table_head_cpas">Nro Asiento</th>
                                <th class="text-center border_table_head_cpas">Precio Pasaje</th>
                                <th class="text-center border_table_head_cpas">Nombre Promoción</th>
                                <th class="text-center border_table_head_cpas">Descuento Promoción</th>
                            </thead>
                            <tbody class="border_table_body_cpas">
                                <tr class="border_table_body_cpas" *ngFor="let arrayDatos of subArrayFinal; index as i;">
                                    <td class="text-center border_table_body_cpas">{{i+1}}</td>
                                    <td class="text-center border_table_body_cpas">
                                        <i class="fad fa-user" style="color: #575757;"></i>&nbsp; 
                                            {{arrayDatos['ventaIda']['pasajero']['nombre']}}&nbsp;{{arrayDatos['ventaIda']['pasajero']['apePaterno']}}&nbsp;{{arrayDatos['ventaIda']['pasajero']['apeMaterno']}}
                                        </td>
                                    <td class="text-center border_table_body_cpas">
                                        <font>
                                            <i class="fad fa-chair-office" style="color: green;"></i>&nbsp; {{arrayDatos['ventaIda']['nroAsiento']}}
                                        </font>
                                    </td>
                                    <td class="text-center border_table_body_cpas">S/. {{arrayDatos['ventaIda']['impPagado']}}</td>
                                    <td class="text-center border_table_body_cpas">
                                        <font *ngIf="arrayDatos['ventaIda']['namePromocion'] == null || arrayDatos['ventaIda']['namePromocion'] == ''">-</font>
                                        <font *ngIf="arrayDatos['ventaIda']['namePromocion'] != null || arrayDatos['ventaIda']['namePromocion'] != ''">{{arrayDatos['ventaIda']['namePromocion']}}</font>
                                    </td>
                                    <td class="text-center border_table_body_cpas">
                                        <font *ngIf="arrayDatos['ventaIda']['descuento'] == 0">-</font>
                                        <font *ngIf="arrayDatos['ventaIda']['descuento'] != 0">{{arrayDatos['ventaIda']['descuento']}}</font>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <br>

                <!------------------------------------------------------------ VUELTA ------------------------------------------------------------>
                <div *ngIf="ida_vuelta == 2" class="card card-itinerario">
                    <div class="row g-0" style="display: flex; justify-content: center; border: 1px solid #cdcdcd;">
                        <div class="col-10 div_servicio_cpas">
                            <div style="margin-top: 2%; text-align: left;">
                                <div class="servicio_cpas">Servicio 
                                    <font class="servicio_detall_cpas">{{servicioVuelta}}</font> 
                                    <div class="icon_detalle_cpas"><font style="font-weight: bold;">Vuelta</font>&nbsp;<i class="fal fa-calendar-check"></i>&nbsp;{{this.funcionesService.convert_format_fecha_barra(fechaEmbarqueVuelta)}}</div>
                                </div>
                            </div>
                            <div class="col-12 col-lg-12">
                                <div class="row" style="margin-top: 10px;">
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="font_ruta_cpas">{{nombre_ciudad_destino}}</span>
                                    </div>
                                    <div class="col-2" style="text-align: center;">
                                        <i class="fal fa-long-arrow-right icon_flecha_cpas"></i>
                                    </div>
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="font_ruta2_cpas">{{nombre_ciudad_origen}}</span>
                                    </div>
                                </div>
                                <div class="row" style="margin-top: -12px;">
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="dat_salida_embar_cpas">Embarque</span>
                                        <span class="dat_hora_embar_cpas">{{horaEmbarqueVuelta}} h</span>
                                    </div>
                                    <div class="col-2" style="text-align: center;">&nbsp;</div>
                                    <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                        <span class="dat_llegada_desem_cpas">Desembarque</span>
                                        <span class="dat_hora_desem_cpas">{{horaDesembarqueVuelta}} h</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-10 margin_embarque_desembarque_cpas">
                            <div class="row">
                                <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                    <span class="dat_salida_embar_detall_cpas">{{agenciaEmbarqueVuelta}}</span>
                                </div>
                                <div class="col-2" style="text-align: center;">&nbsp;</div>
                                <div class="col-5" style="display: flex; flex-direction: column; text-align: center;">
                                    <span class="dat_llegada_desem_detall_cpas">{{agenciaDesembarqueVuelta}}</span>
                                </div>
                            </div>
                        </div>

                        <table style="margin-top: 8px;">
                            <thead class="border_table_head_cpas">
                                <th class="text-center border_table_head_cpas">#</th>
                                <th class="text-center border_table_head_cpas">Nombre del Pasajero</th>
                                <th class="text-center border_table_head_cpas">Nro Asiento</th>
                                <th class="text-center border_table_head_cpas">Precio Pasaje</th>
                                <th class="text-center border_table_head_cpas">Nombre Promoción</th>
                                <th class="text-center border_table_head_cpas">Descuento Promoción</th>
                            </thead>
                            <tbody class="border_table_body_cpas">
                                <tr class="border_table_body_cpas" *ngFor="let arrayDatos of subArrayFinal; index as i;">
                                    <td class="text-center border_table_body_cpas">{{i+1}}</td>
                                    <td class="text-center border_table_body_cpas">
                                        <i class="fad fa-user" style="color: #575757;"></i>&nbsp; 
                                            {{arrayDatos['ventaVuelta']['pasajero']['nombre']}}&nbsp;{{arrayDatos['ventaVuelta']['pasajero']['apePaterno']}}&nbsp;{{arrayDatos['ventaVuelta']['pasajero']['apeMaterno']}}
                                        </td>
                                    <td class="text-center border_table_body_cpas">
                                        <font>
                                            <i class="fad fa-chair-office" style="color: green;"></i>&nbsp; {{arrayDatos['ventaVuelta']['nroAsiento']}}
                                        </font>
                                    </td>
                                    <td class="text-center border_table_body_cpas">S/. {{arrayDatos['ventaVuelta']['impPagado']}}</td>
                                    <td class="text-center border_table_body_cpas">
                                        <font *ngIf="arrayDatos['ventaVuelta']['namePromocion'] == null || arrayDatos['ventaVuelta']['namePromocion'] == ''">-</font>
                                        <font *ngIf="arrayDatos['ventaVuelta']['namePromocion'] != null || arrayDatos['ventaVuelta']['namePromocion'] != ''">{{arrayDatos['ventaVuelta']['namePromocion']}}</font>
                                    </td>
                                    <td class="text-center border_table_body_cpas">
                                        <font *ngIf="arrayDatos['ventaVuelta']['descuento'] == 0">-</font>
                                        <font *ngIf="arrayDatos['ventaVuelta']['descuento'] != 0">{{arrayDatos['ventaVuelta']['descuento']}}</font>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!------------------------------------------------------------ VUELTA ------------------------------------------------------------>
            </div>
            <div class="col-md-2 gx-xl-10 mb-5" style="align-content: normal;">
                <button id="btn_atras" class="btn btn-sm btn-secondary" (click)="btn_atras()">
                    <i class="fad fa-chevron-left"></i> ATRÁS
                </button>

                <button id="btn_nueva_venta" class="btn btn-sm btn-secondary" style="display: none;" (click)="btn_nuevo()">
                    <i class="fad fa-plus-circle"></i> NUEVA VENTA
                </button>
            </div>
            <br>
            <div class="col-xxl-8 col-9" style="display: inline-block;">
                <div class="card card-xl-stretch mb-xl-8" style="border-color: #c5c5c5;">
                    <div class="card-header align-items-center border-0 mt-4">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="fw-bold mb-2 text-gray-900">Grabación de Venta:</span>
                            <!--<span class="text-muted fw-semibold fs-7">890,344 Sales</span>-->
                        </h3>
                    </div>
                    <div class="card-body pt-5" style="text-align: left;">
                        <div class="timeline-label">
                            <div class="timeline-item">
                                <div class="timeline-label fw-bold text-gray-800 fs-6 text-center"></div>
                                <div class="timeline-badge">
                                    <i class="fa fa-genderless text-success fs-1"></i>
                                </div>
                                <div class="fw-mormal timeline-content ps-3" style="color: #6c6a81 !important;">
                                    A continuación realizaremos la grabación del servicio que esta contratando, le pedimos darnos la conformidad al finalizaar la lectura, ya que sus pasajes serán emitidos con estos datos:
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-label fw-bold text-gray-800 fs-6 text-center"></div>
                                <div class="timeline-badge">
                                    <i class="fa fa-genderless text-success fs-1"></i>
                                </div>
                                <div id="texto_venta_pasaje" class="fw-mormal timeline-content ps-3" style="color: #6c6a81 !important;">
                                    
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-label fw-bold text-gray-800 fs-6 text-center"></div>
                                <div class="timeline-badge">
                                    <i class="fa fa-genderless text-success fs-1"></i>
                                </div>
                                <div class="fw-mormal timeline-content ps-3" style="color: #6c6a81 !important;"> 
                                    ¿Todo conforme?
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-label fw-bold text-gray-800 fs-6 text-center"></div>
                                <div class="timeline-badge">
                                    <i class="fa fa-genderless text-success fs-1"></i>
                                </div>
                                <div class="fw-mormal timeline-content ps-3" style="color: #6c6a81 !important;"> 
                                    Recuerde que debe presentarse <b>45 minutos antes de la salida del bus</b>, portando <b>DNI fisico y boleto (Físico o digital)</b>.<br>
                                    Su equipaje en mano <b>no debe exceder los 8 kg y en bodega los 20kg</b>. Ambos deben de ser exclusivo de uso personal.
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-label fw-bold text-gray-800 fs-6 text-center"></div>
                                <div class="timeline-badge">
                                    <i class="fa fa-genderless text-success fs-1"></i>
                                </div>
                                <div class="fw-mormal timeline-content ps-3" style="color: #6c6a81 !important;"> 
                                    *Está restringido el embarque con alimentos. Solo se permitirá el embarque con snacks y/o bebidas selladas (Galletas, agua o frutas), teniendo en cuenta que no contamos con tripulante a bordo.<br><br>
                                    Asimismo, los boletos de viaje, junto con los protocolos para el embarque, <b>serán enviados al correo electrónico: {{emailCliente}},</b> que fue otorgado durante el proceso de compra después de realizado el pago según el metodo del pago elegido.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <br>

            <div class="col-xxl-8 col-9" style="display: inline-block;">
                <div class="card card-xl-stretch mb-xl-8" style="border-color: #c5c5c5;">
                    <div class="card-header border-0" style="margin: -3px 0px 0px 0px;">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="fw-bold mb-2 text-gray-900" style="font-size: 16px;">Observaciones:</span>
                            <span class="text-muted fw-semibold fs-7">* Agregar teléfono de comunicación (Obligatorio)</span>
                        </h3>
                    </div>
                    <div class="card-body" style="padding: 0rem 2rem 1rem 2rem;">
                        <textarea id="texto_observaciones" rows="7" maxlength="299" style="resize: none; border: 1px solid #a3a3a3; color: #6c6a81; padding: 8px; width: 100%;"></textarea>
                    </div>
                </div>
            </div>

            <br>

            <div class="col-xxl-8 col-9" style="display: inline-block;">
                <div class="card card-xl-stretch mb-xl-1" style="border-color: #c5c5c5;">
                    <div class="card-body pt-5" style="text-align: center; color: #6c6a81 !important; padding-bottom: 30px;">
                        ¿Contamos con dos métodos de pagos?
                    </div>
                </div>
            </div>
            <br>
            <div class="col-xxl-8 col-9" style="margin-top: 10px;">
                <div class="row justify-content-md-center">
                    <div id="div_pago_tarjetas" class="col-6" style="margin-bottom: 10px;">
                        <div class="card">
                            <div class="card-header" style="background-color: #d9d9d9; color: #5d5d5d; font-weight: bold; border-bottom: 0px; font-size: 13px; padding-top: 5%; padding-bottom: 5%;">
                                <div style="text-align: center;">
                                    <b style="color: #242424;">Pago Link:</b> Es un enlace de pago seguro de Niubiz que le llegará a través de su correo electrónico, en este enlace deberá ingresar los datos de su tarjeta para la cancelación del importe total de sus pasajes, el importe le aparecerá de forma automática.<br>
                                    <!--<img alt="image_pago_tarjetas" style="width: 30%;" src="./assets/img/billetera_digital_niubiz.png">-->
                                </div>
                            </div>
                            <div class="card-body text-center" style="background-color: white; padding: 0 0;">
                                <img alt="image_pago_tarjetas" style="width: 70%;" src="./assets/img/billetera_digital_pagos.png">
                            </div>
                            <div id="btn_pague_payment" (click)="pagarPaymentPagoEfectivo(4)" class="card-footer text-center" style="background-color: #ff6719; color: white; font-size: 16px; font-weight: bold; padding: 13px; cursor: pointer;">
                                Generar enlace de pago
                            </div>
                        </div>
                    </div>

                    <!--<div id="div_pago_efectivo" class="col-6" style="margin-bottom: 10px; display: none;">
                        <div class="card">
                            <div class="card-header" style="background-color: #d9d9d9; color: #5d5d5d; font-weight: bold; border-bottom: 0px; font-size: 13px; padding-top: 5%; padding-bottom: 5%;">
                                <div style="text-align: center; width: 100%;">
                                    <b style="color: #242424;">Pago Efectivo:</b> Es la empresa recaudadora de pagos de Movil Bus, le proporcionaremos un código de pago para la cancelación del importe total de sus pasajes, este pago se podrá realizar a través de banca móvil, agente y ventanilla del banco de su elección.
                                </div>
                            </div>
                            <div class="card-body text-center" style="background-color: white;">
                                <img alt="image_pago_efectivo" style="width: 49%;" src="./assets/img/pago_pago_efectivo.png">
                            </div>
                            <div id="btn_pague_pagoefectivo" (click)="pagarPaymentPagoEfectivo(11)" class="card-footer text-center" style="background-color: #ff6719; color: white; font-size: 16px; font-weight: bold; padding: 13px; cursor: pointer;">
                                Generar código CIP
                            </div>
                        </div>
                    </div>-->
                </div>
            </div>
            
            <div class="col-xxl-8 col-9" style="margin-top: 10px;">
                <div id="card_pagolink" class="card" style="border-color: #c5c5c5; cursor: pointer; display: none;" data-toggle="tooltip" title="Click para copiar" (click)="clickParaCopiarPagoLink()">
                    <div class="card-body d-flex align-items-center" style="padding: 2rem 3.25rem;">
                        <div style="text-align: center; width: 100%;">
                            <font id="texto_card_pagolink0" style="font-size: 15px; color: #1B84FF;">URL PagoLink:</font>&nbsp; 
                            <font id="texto_card_pagolink" style="font-size: 15px; text-decoration: underline; color: #1B84FF;">{{linkPagoLink}}</font> &nbsp;&nbsp; 
                            <i class="fad fa-copy" id="icono1_card_pagolink" style="font-size: 18px; color: #1B84FF;"></i>
                            <i class="fad fa-check-circle" id="icono2_card_pagolink" style="font-size: 18px; color: white; display: none;"></i>
                        </div>
                    </div>
                </div>
                <div id="card_pagoefectivo" class="card" style="border-color: #c5c5c5; cursor: pointer; display: none;" data-toggle="tooltip" title="Click para copiar" (click)="clickParaCopiarPagoEfectivo()">
                    <div class="card-body d-flex align-items-center" style="padding: 2rem 3.25rem;">
                        <div style="text-align: center; width: 100%;">
                            <font id="texto_card_pagoefectivo0" style="font-size: 15px; color: #ff6719;">URL PagoEfectivo (CIP):</font>&nbsp; 
                            <font id="texto_card_pagoefectivo" style="font-size: 15px; text-decoration: underline; color: #ff6719;">{{numPagoEfectivo}}</font> &nbsp;&nbsp; 
                            <i class="fad fa-copy" id="icono1_card_pagoefectivo" style="font-size: 18px; color: #ff6719;"></i>
                            <i class="fad fa-check-circle" id="icono2_card_pagoefectivo" style="font-size: 18px; color: #000000; display: none;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>